---
layout: post
title: "[React] ë¦¬ì•¡íŠ¸ í›…ì´ ì‹¤íŒ¨í•œ ì„¤ê³„ì¸ ì´ìœ  ë„¤ê°€ì§€"
subtitle: "ë¦¬ì•¡íŠ¸ í›…ì´ ì‹¤íŒ¨í•œ ì„¤ê³„ì¸ ì´ìœ  ë„¤ê°€ì§€"
categories: devlog
tags: js javascript front-end í”„ë¡ íŠ¸ì—”ë“œ ë¦¬ì•¡íŠ¸ React hooks React-hooks í›… í›…ìŠ¤
comments: true
header-img: "/img/posts/react-hooks-sucks/header.jpeg"
---

# ë¦¬ì•¡íŠ¸ í›…ì´ ì‹¤íŒ¨í•œ ì„¤ê³„ì¸ ì´ìœ  4ê°€ì§€

ë³¸ë¬¸ì— ë“¤ì–´ê°€ê¸° ì•ì„œ, í•„ìëŠ” `ë¦¬ì•¡íŠ¸ í›…`ì„ ì‹¤ë¬´ì—ì„œ 1ë…„ê°„ ì‚¬ìš©í–ˆê³ , ì•„ì§ë„ `ë¦¬ì•¡íŠ¸ í›…`ì„ ì‚¬ìš©í•˜ê³  êµ‰ì¥í•œ íŒ¬ì´ë€ ê±¸ ë°íŒë‹¤.
ê·¸ë¦¬ê³ , ë¶„ëª… `ë¦¬ì•¡íŠ¸ í›…`ì´ **ì„±ê³µí•œ ì„¤ê³„**ì¸ ì´ìœ ê°€ ì—¬ëŸ¬ê°€ì§€ ìˆë‹¤.  

í•˜ì§€ë§Œ ì´ ê¸€ì—ì„  `ë¦¬ì•¡íŠ¸ í›…` ê·¸ë¦¬ê³  `Function component`ê°€ ì™œ **ì‹¤íŒ¨í•œ ì„¤ê³„**ì¸ì§€ì— ëŒ€í•˜ì—¬ ë‹¤ë£° ì˜ˆì •ì´ë‹¤.

ë§¤ìš° ê¸´ ê¸€ì´ë‹¤. [TLDL](#ê²°ë¡ )


## ë“¤ì–´ê°€ê¸° ì•ì„œ
ë¦¬ì•¡íŠ¸ í›…(ì´í•˜ Hooks)ì€ í˜„ì¬ ë„ˆë¬´ ê³¼ëŒ€í‰ê°€ ë˜ì–´ìˆë‹¤.  
í•œêµ­ì˜ ë§ì€ ë¸”ë¡œê·¸ ê¸€ë“¤ì´ Hooksì— ëŒ€í•´ ë¹„íŒì„ ì „í˜€ í•˜ì§€ ì•ŠëŠ”ë‹¤.  

ë‚´ê°€ ëŠê¼ˆì„ ë•Œ, ë§ì€ ê¸€ë“¤ì´ `Function component(hooks)`ë¥¼ `Class component`ì˜ ìƒìœ„í˜¸í™˜ì´ë¼ê³  ìƒê°í•˜ëŠ” ê²ƒ ê°™ë‹¤.


### jQuery

í”„ë¡ íŠ¸ì—”ë“œì— ì…ë¬¸í•˜ëŠ” ì‚¬ëŒë“¤ì´ `React`ë¥¼ ë¨¼ì € ë°°ìš°ëŠ” ê²ƒì„ ì•Œê³ ìˆë‹¤.  
ì‹¤ì œë¡œ â€œ`html, js, css`? ë°°ìš°ì§€ ë§ˆì„¸ìš”. `React`ë¨¼ì € ë°°ìš°ì„¸ìš”.â€ ë¼ëŠ” ë§ë„ ë“¤ì—ˆì—ˆë‹¤.

ë¬¼ë¡  ë§ëŠ” ë§ì¼ ìˆ˜ë„ ìˆë‹¤. í•˜ì§€ë§Œ ì–´ë–¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ìƒê°ë‚˜ëŠ” ë§ ì•„ë‹Œê°€?  
`jQuery`ëŠ”  `Angular, React, Vue`ê°€ ë“±ì¥í•˜ê¸° ì´ì „, ë§ì€ ì‚¬ëŒë“¤ì´(ë¬¼ë¡  ë‚˜ë„ í¬í•¨) ì‚¬ìš©í•˜ë˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë‹¤.

ì´ì œëŠ” `jQuery`ë¥¼ ë§ì´ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ê·¸ ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

- ë¸Œë¼ìš°ì €ì˜ ë°œì „
- `React, Vue`ì™€ ê°™ì€ `VDom`ë¼ì´ë¸ŒëŸ¬ë¦¬(í”„ë ˆì„ì›Œí¬)ì˜ ë“±ì¥
- ~~ê°œë°œìë“¤ì˜ íƒ€ë„ìš´ë™(?)~~

í•„ìëŠ” 3ë…„ë™ì•ˆ jQueryë¥¼ ì‚¬ìš©í–ˆê³ , jQueryì˜ ê°œë°œ ìƒì‚°ì„±ì´ ë›°ì–´ë‚˜ë‹¤ëŠ” ê²ƒì„ ì•Œê³ ìˆë‹¤.

ë‚´ê°€ jQueryë¥¼ ì²˜ìŒ ì‚¬ìš©í•  ë•ŒëŠ”, `javascript == jQuery` ì¸ì¤„ ì•Œì•˜ë‹¤. 
`javascript`ë¥¼ ì²˜ìŒ ë°°ìš¸ ë•Œ  `$(function () {})`ë¥¼ ì¼ìœ¼ë‹ˆê¹Œ.

ë§ì€ ì‚¬ëŒë“¤ì´ ê·¸ë¬ì„ ê±°ë¼ê³  ë¯¿ì–´ ì˜ì‹¬ì¹˜ ì•ŠëŠ”ë‹¤.

ê·¸ëŸ°ë°, ìš”ì¦˜ ë¬¸ë“ ë“œëŠ” ìƒê°ì´ â€`javascript == React`ê°€ ì•„ë‹ê¹Œ?â€ ë€ ìƒê°ì´ë‹¤.  
ê·¸ë„ ê·¸ëŸ´ ê²ƒì´, ëˆ„êµ°ê°€ í”„ë¡ íŠ¸ì—”ë“œì— ì…ë¬¸í•˜ë©´, `html, js, css`ëŠ” ìŠ¤í‚µí•˜ê³ , `jsx(html), React(js)`ë¥¼ ë°°ìš´ë‹¤.

`React`ë¡œ ì¸ìŠ¤íƒ€ê·¸ë¨ì€ ì˜ ë§Œë“¤ì§€ë§Œ, `html, js, css`ë¡œ ë§Œë“¤ë¼ê³  í•˜ë©´ **ëª» ë§Œë“ ë‹¤**.  
ë‚´ê°€ `jQuery`ê°€ ì—†ìœ¼ë©´ ë²™ì–´ë¦¬ê°€ ëì„ ë•Œê°€ ìƒê°ë‚œë‹¤.

ë‚˜ëŠ” ì§€ê¸ˆ `React`ë¹„ê´€ë¡ ê³¼ `jQuery`ì°¬ì–‘ë¡ ì„ ì£¼ì¥í•˜ëŠ” ê²Œ ì•„ë‹ˆë‹¤.  

í•˜ì§€ë§Œ, `React`ê°€ ì—†ì–´ì§€ë©´?  
ë¬¼ë¡  ì—†ì–´ì§ˆ ì¼ì€ ì—†ë‹¤. ë‚´ê°€ ë§í•˜ê³ ì í•˜ëŠ” ê²ƒì€. `React`ê°€ ì•„ë‹Œ, ë‹¤ë¥¸ ë¼ì´ë¸ŒëŸ¬ë¦¬`(Svelte, element)` ë¡œ ê°œë°œí•˜ë ¤ê³  í•˜ë©´, ë¶„ëª… ë§ì´ í˜ë“¤ ê²ƒì´ë‹¤.

í•„ìëŠ” `jQuery -> javascript -> Vue, React`ìˆœìœ¼ë¡œ ê³µë¶€ë¥¼ í–ˆëŠ”ë°, `jQuery -> Vue, React`ìˆœìœ¼ë¡œ ê³µë¶€ë¥¼ í–ˆë‹¤ë©´ ì •ë§ í˜ë“¤ì—ˆì„ ê²ƒ ê°™ë‹¤.

ì—¬ê¸°ì„œ `javascript`ë¥¼ ê³µë¶€í•¨ì€, ë¬¸ë²•ì„ ê³µë¶€í•œë‹¤ëŠ” ê²Œ ì•„ë‹ˆë¼, ë¬¸ì œì˜ ë°œìƒ, í•´ê²°ì— ëŒ€í•œ ê²½í—˜ì„ ì–˜ê¸°í•œë‹¤.

ë‚œ ì‹¤ì œë¡œ, `jQuery`ì™€ `javascript`ë¥¼ ì‚¬ìš©í•˜ë©´ì„œ, `javascript`ì˜ ëª¨í˜¸í•¨ì— ì¸í•´ ìƒê¸°ëŠ” ë¬¸ì œ(ì˜ˆë¥¼ ë“¤ì–´, ì£¼ì†Œ ì°¸ì¡°, ë¶ˆë³€ì„±, ì´ë²¤íŠ¸ì™€ ê°™ì€ ë¬¸ì œ ë“±)ì„ í•´ê²°í•œ ê²½í—˜ì´.  
`React`ë¥¼ ë°°ìš¸ ë•Œ ë§ì€ ë„ì›€ì´ ë˜ì—ˆë‹¤. ë°°ìš°ë©´ì„œ, â€œì•„.. ì´ëŸ° ë¬¸ì œ ë•Œë¬¸ì— ì´ë ‡ê²Œ ì„¤ê³„í–ˆêµ¬ë‚˜.â€ë¼ëŠ” ìƒê°ì´ ë§ì´ ë“¤ì—ˆë‹¤.

- - - -

## Reactì˜ jQueryí™”(åŒ–)

`2025ë…„, í•œ ê¸°ìˆ  ë¸”ë¡œê·¸ ê²Œì‹œê¸€ ì¤‘ ë°œì·Œ`

> ì´ì œëŠ” `React`ë¥¼ ë§ì´ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ê·¸ ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.  
>   
> - ë¸Œë¼ìš°ì €ì˜ ë°œì „ (VDomì„ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ì„±ëŠ¥ ì¶©ë¶„)  
> - `Svelte`ì™€ ê°™ì€ `VDom`ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬(í”„ë ˆì„ì›Œí¬)ì˜ ë“±ì¥  
> - **React Hooksì˜ ë‹¨ì **  


## React Hooksì˜ ë‹¨ì 

### 1. useEffectëŠ” ì™„ë²½í•˜ì§€ ì•Šë‹¤.

`useEffect`í›…ì´ë€? ê¸°ì¡´`Class Component`ì˜ `ë¼ì´í”„ ì‚¬ì´í´ ë©”ì„œë“œë“¤`ì„ ëŒ€ì²´í•  ìˆ˜ ìˆëŠ” ê¸°ë³¸ í›…ì´ë‹¤.  

`useEffect`ëŠ” ë‘ë²ˆì§¸ ì¸ìë¡œ ì¢…ì†ì„± ë¦¬ìŠ¤íŠ¸ë¥¼ ë°›ê³ , ì´ ì¢…ì†ì„± ì¤‘ í•˜ë‚˜ë¼ë„ **ë³€ê²½**ëì„ ë•Œ, ì‹¤í–‰í•˜ëŠ” ê²ƒì„ í†µí•´ `ë¼ì´í”„ ì‚¬ì´í´`ì„ **í‰ë‚´**ë‚¼ ìˆ˜ ìˆë‹¤.  

> `React`ì—ì„œì˜ **ë³€ê²½**ì€ `Object.is`ë¥¼ ì¼ì»«ëŠ”ë‹¤.  

`Object.is`ëŠ” ëŒ€ì²´ë¡œ ì›ì‹œì ì¸ íƒ€ì…ì— ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•œë‹¤.  
ë¬¸ì œëŠ”, ì›ì‹œì ì¸ íƒ€ì…(string, number ë“±)ì´ ì•„ë‹Œ, ë°°ì—´ í˜¹ì€ ê°ì²´ì¼ ë•Œì— ë°œìƒí•œë‹¤.

`Object.is`ëŠ” ê°ì²´ê°€ ë¹„êµë˜ë©´, ì°¸ì¡°(reference)ë¡œ ë¹„êµí•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´.

```javascript
const a = { test: 'a' }
const b = { test: 'a' }

Object.is(a, b) // false
Object.is(a, a) // true
```
ì´ëŸ° ì‹ì´ë‹¤. 

ë‹¤ìŒê³¼ ê°™ì€ ì˜ˆì œì—ì„œëŠ”, ëª¨ë“  ë Œë”ë§ë§ˆë‹¤ `useEffect`ê°€ ì‹¤í–‰ëœë‹¤.

```javascript
const useFetch = (config: ApiOptions) => {
  const  [data, setData] = useState(null);

  useEffect(() => {
    const { url, skip, take } = config;
    const resource = `${url}?$skip=${skip}&take=${take}`;
    axios({ url: resource }).then(response => setData(response.data));
  }, [config]); // <-- ëª¨ë“  ë Œë”ë§ë§ˆë‹¤ httpìš”ì²­ì„ í•œë‹¤

  return data;
};

const App: React.FC = () => {
  const data = useFetch({ url: "/users", take: 10, skip: 0 });
  return <div>{data.map(d => <div>{d})}</div>;
};
```

ë¬¼ë¡ , `useFetch({ url: "/users", take: 10, skip: 0 });` ì´ ì½”ë“œë¥¼ `useMemo`ì™€ ê°™ì´ ë§¤ë²ˆ ë™ì¼í•œ ê°ì²´ê°€ ì „ë‹¬ë  ìˆ˜ ìˆë„ë¡ ì²˜ë¦¬ë¥¼ í•˜ë©´ í•´ë‹¹ ë¬¸ì œëŠ” í•´ê²°ëœë‹¤.  

ë‚˜ëŠ” ì´ëŸ° ë¬¸ì œë¥¼ ê°œë°œí•˜ë©° ë§ì´ ê²ªì—ˆë‹¤. [í•´ë‹¹ ì´ìŠˆ](https://github.com/facebook/react/issues/14476#issuecomment-471199055)ë¥¼ ë³´ë©´, ì´ë¥¼ í•´ê²°í•˜ëŠ” ë°©ë²•ë“¤ì´ ìˆë‹¤.

- - - -

### 2. HooksëŠ” í˜¸ì¶œë˜ëŠ” ìˆœì„œì— ì˜ì¡´í•œë‹¤.

`Hooks`ëŠ” ê·œì¹™ì´ ìˆë‹¤. [Hookì˜ ê·œì¹™ â€“ React](https://ko.reactjs.org/docs/hooks-rules.html)

ì´ ì¤‘ í•˜ë‚˜ëŠ”, â€œ**ë°˜ë³µë¬¸, ì¡°ê±´ë¬¸ í˜¹ì€ ì¤‘ì²©ëœ í•¨ìˆ˜ ë‚´ì—ì„œ Hookì„ í˜¸ì¶œí•˜ì§€ ë§ˆì„¸ìš”.**â€ì´ë‹¤. 

ì´ê²Œ ë¬¸ì œë˜ëŠ” ê²½ìš°ëŠ”, ì‚¬ì‹¤ ê½¤ ë§ë‹¤. í•˜ë‚˜ë§Œ ì˜ˆë¥¼ ë“¤ì–´ë³´ì.

**!! ëª©í‘œ!) ìœ ì € ë¦¬ìŠ¤íŠ¸ì™€ í´ë¦­í•˜ë©´ í˜ì´ì§•ë˜ëŠ” ë²„íŠ¼ì„ êµ¬í˜„í•˜ì—¬ë¼. (useFetchë¥¼ ì‚¬ìš©í•˜ì‹œì˜¤) !!**

ì, ìš°ë¦° í•´ë‹¹ ëª©í‘œë¥¼ ë‹¬ì„±í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì‘ì„±í–ˆë‹¤.

```javascript
const App: React.FC = () => {
  const [currentPage, setCurrentPage] = useState<ApiOptions>({
    take: 10,
    skip: 0
  });

  const [users, loading] = useFetch(currentPage);

  if (loading) {
    return <div>loading....</div>;
  }

  return (
    <>
      {users.map((u: User) => (
        <div>{u.name}</div>
      ))}
      <ul>
        {[...Array(4).keys()].map((n: number) => (
          <li>
            <button onClick={() => console.log('ì—¬ê¸°ì„œ useFetchë¥¼ í˜¸ì¶œí•˜ë©´ ì—ëŸ¬ê°€ ë‚˜ì˜¨ë‹¤')}>{n + 1}</button>
          </li>
        ))}
      </ul>
    </>
  );
};

```

ìš°ë¦° ë²„íŠ¼ì„ í´ë¦­í–ˆì„ ë•Œ `useFetch`ë¥¼ ì‚¬ìš©í•˜ë ¤ê³  í–ˆë‹¤. í•˜ì§€ë§Œ, `Hooks`ì˜ ê·œì¹™ì¤‘ í•˜ë‚˜ì¸ â€œ**ë°˜ë³µë¬¸, ì¡°ê±´ë¬¸ í˜¹ì€ ì¤‘ì²©ëœ í•¨ìˆ˜ ë‚´ì—ì„œ Hookì„ í˜¸ì¶œí•˜ì§€ ë§ì•„ì•¼í•œë‹¤**â€ë•Œë¬¸ì— ìš°ë¦° ì¢€ ë§ì´ ëŒì•„ê°€ì•¼ í–ˆë‹¤.

ì´ ê·œì¹™ì´ `Hooks`ì˜ ê·œì¹™ì´ í¬í•¨ë˜ì–´ ìˆëŠ” ì´ìœ ëŠ” ë‹¤ìŒ ê¸€ì— ì„¤ëª…ë˜ì–´ì‡ë‹¤. ([Why Do React Hooks Rely on Call Order? â€” Overreacted](https://overreacted.io/why-do-hooks-rely-on-call-order/))

#### ê·¸ëŸ¼ Hooksë¥¼ ê³ ì°¨í•¨ìˆ˜ë¡œ ë§Œë“¤ì–´ë³´ì.

ê·¸ëŸ¼ ìš°ë¦° ì´ì œ `custom hooks`ë¼ëŠ” ê²ƒì„ ì‚¬ìš©í•˜ì—¬ ì´ ë¬¸ì œë¥¼ í•´ê²°í•´ ë³´ë ¤ê³  í–ˆë‹¤.

> ê²°êµ­ ìš°ë¦° Hooksë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ Hooksë¥¼ ë§Œë“ ë‹¤.  

[react-async-hook](https://github.com/slorber/react-async-hook)ëŠ” ìš°ë¦¬ê°€ ë§Œë“¤ê³ ì í•˜ëŠ” `custom hook` ê¸°ëŠ¥ì„ ê°€ì§€ê³  ìˆë‹¤. í•˜ì§€ë§Œ ìš°ë¦° ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³ , ì§ì ‘ êµ¬í˜„í•´ë³´ê² ë‹¤.

**!! êµ³ì´ ì´ ì˜ˆì œ ì½”ë“œë¥¼ ì „ë¶€ ì½ì„ í•„ìš”ëŠ” ì—†ë‹¤. í•µì‹¬ì€ ìš°ë¦¬ê°€ `Hooks`ì˜ ê·œì¹™ì„ ë”°ë¥´ê¸° ìœ„í•´ ë„ˆë¬´ ë§ì€ ë¦¬ì†ŒìŠ¤ë¥¼ ì“°ê³ , ë˜ ì´ ì½”ë“œë“¤ì´ ë³µì¡ì„±ì„ ì¦ê°€ì‹œí‚¨ë‹¤ëŠ” ê²ƒì´ë‹¤. !!**

```javascript
const createTask = (func, forceUpdateRef) => {
  const task = {
    start: async (...args) => {
      task.loading = true;
      task.result = null;
      forceUpdateRef.current(func);
      try {
        task.result = await func(...args);
      } catch (e) {
        task.error = e;
      }
      task.loading = false;
      forceUpdateRef.current(func);
    },
    loading: false,
    result: null,
    error: undefined
  };
  return task;
};

export const useAsyncTask = (func) => {
  const forceUpdate = useForceUpdate();
  const forceUpdateRef = useRef(forceUpdate);
  const task = useMemo(() => createTask(func, forceUpdateRef), [func]);

  useEffect(() => {
    forceUpdateRef.current = f => {
      if (f === func) {
        forceUpdate({});
      }
    };
    const cleanup = () => {
      forceUpdateRef.current = () => null;
    };
    return cleanup;
  }, [func, forceUpdate]);

  return useMemo(
    () => ({
      start: task.start,
      loading: task.loading,
      error: task.error,
      result: task.result
    }),
    [task.start, task.loading, task.error, task.result]
  );
};

export const useFetch = (initial: ApiOptions) =>
  useAsyncTask(
    useCallback(
	    async (overrides: ApiOptions) => {
        return api({ ...initial, ...overrides });
      },
      [initial]
    )
);
```

ì, ì´ì œ ìš°ë¦¬ê°€ ë§Œë“   `useAsyncTask `ì˜ `start`ë¥¼ `Function component`ì•ˆì—ì„œ  `Hooks`ì˜ ê·œì¹™ì— ì–´ê¸‹ë‚˜ì§€ ì•Šê³   ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤..!

> ì–´ë””ì„ ê°€ ë“¤ë¦¬ëŠ” ëª©ì†Œë¦¬, â€œë­”ê°€ **ì˜ëª»ëœ ëŠë‚Œ**ì´ ë“¤ì§€ ì•ŠëŠ”ê°€? ì´ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„  ê¼­ ì´ë ‡ê²Œ ì´í•´í•˜ê¸° í˜ë“  ì½”ë“œë“¤ë¡œ ê°€ë“í•´ì•¼í• ê¹Œ?â€  

ì—¬ê¸°ì„œ ëì´ ì•„ë‹ˆë‹¤. ìš°ë¦¬ì˜ ëª©í‘œëŠ” ë²„íŠ¼ì´ í´ë¦­ë˜ì—ˆì„ ë•Œ ë§ê³ ë„ ìœ ì € ë¦¬ìŠ¤íŠ¸ë¥¼ ë¶ˆëŸ¬ì™€ì•¼ í•œë‹¤.

```javascript
export const useAsyncRun = (
  asyncTask: ReturnType<typeof useAsyncTask>,
  ...args: any[]
) => {
  const { start } = asyncTask;
  useEffect(() => {
    start(...args);
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [asyncTask.start, ...args]);
  useEffect(() => {
    const cleanup = () => {
      // clean up code here
    };
    return cleanup;
  });
};
```

ì´ì œ ì´ ì½”ë“œê¹Œì§€ ì ìš©ì‹œí‚¤ë©´, ìš°ë¦¬ëŠ” ë“œë””ì–´ ëª©í‘œë¥¼ ë‹¬ì„±í•  ìˆ˜ ìˆë‹¤..!!

ê·¸ ëª©í‘œëŠ” ê·¸ì € â€œ**ìœ ì € ë¦¬ìŠ¤íŠ¸ì™€ í´ë¦­í•˜ë©´ í˜ì´ì§•ë˜ëŠ” ë²„íŠ¼**â€ì¼ì§€ë¼ë„, ìš°ë¦¬ê°€ ê·¸ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ ì´ë ‡ê²Œ ê³ ë„ì˜(ë³µì¡í•œ) ê¸°ìˆ ì„ ì‚¬ìš©í–ˆìœ¼ë‹ˆ ê´œì°®ë‹¤. â€œê°„ì§€ë‚˜ì–ì•„?â€

```javascript
const App: React.FC = () => {
  const asyncTask = useFetch(initialPage);
  useAsyncRun(asyncTask);

  const { start, loading, result: users } = asyncTask;

  if (loading) {
    return <div>loading....</div>;
  }

  return (
    <>
      {(users || []).map((u: User) => (
        <div>{u.name}</div>
      ))}

      <ul>
        {[...Array(4).keys()].map((n: number) => (
          <li key={n}>
            <button onClick={() => start({ skip: 10 * n, take: 10 })}>
              {n + 1}
            </button>
          </li>
        ))}
      </ul>
    </>
  );
};
```

ì, ì´ì œ ìœ ì € ë¦¬ìŠ¤íŠ¸ë„ ì •í™•íˆ ë‚˜ì˜¤ê³ , í˜ì´ì§• ë²„íŠ¼ë„ ì›í•˜ëŠ” ëŒ€ë¡œ ì‘ë™í•œë‹¤. ğŸ‰

ë‚´ê°€ ì´ë ‡ê²Œê¹Œì§€ (ì–µì§€ìŠ¤ëŸ¬ìš´)ëª©ì ê¹Œì§€ ì„¤ì •í•˜ë©° í•´ë‹¹ ë¬¸ë‹¨, ê·¸ëŸ¬ë‹ˆê¹Œ â€œ**HooksëŠ” í˜¸ì¶œë˜ëŠ” ìˆœì„œì— ì˜ì¡´í•œë‹¤.**â€ì„ ì“´ ì´ìœ ëŠ” ë‹¤ë“¤ ëˆˆì¹˜ì±˜ê² ì§€ë§Œ, ìš°ë¦° ê°„ë‹¨í•œ ê¸°ëŠ¥ì´ë¼ë„ `Hooks`ì˜ ê·œì¹™ì— ë§‰í˜€ ëŒê³  ëŒì•„ê°€ë©° êµ¬í˜„í•´ì•¼ í•œë‹¤ëŠ” ì‚¬ì‹¤ì´ `Hooks`ì˜ ë‹¨ì ì´ë€ ê²ƒì´ë‹¤.

ì´ê²Œ ë°˜ë³µë˜ë©´ ì ì  ì½”ë“œëŠ” ëª©ì ì„ ì•Œì•„ë³´ê¸° í˜ë“¤ê³ , ë³µì¡ì„±ì´ ì¦ê°€í•œë‹¤.

- - - -


### 3. HooksëŠ” í´ë¡œì €(Closure)ì— ë„ˆë¬´ ì˜ì¡´í•œë‹¤.
> [í´ë¡œì € - JavaScript | MDN](https://developer.mozilla.org/ko/docs/Web/JavaScript/Guide/Closures)  

ê²½í—˜ìƒ `Hooks`ëŠ” í´ë¡œì €ì— í¬ê²Œ ì˜ì¡´í•œë‹¤. ì»´í¬ë„ŒíŠ¸ê°€ ì»¤ì§€ë‹¤ë³´ë©´, `Hooks`ë˜í•œ ë§ì•„ì§€ëŠ”ë°, ë§ì€ í´ë¡œì €ë“¤ì€ ë³µì¡ì„±ì„ í¬ê²Œ ì¦ê°€ì‹œí‚¨ë‹¤.

íŠ¹íˆ, `ì˜¤ë˜ëœ í´ë¡œì €(ìµœì‹ ìƒíƒœê°€ ì•„ë‹Œ í´ë¡œì €)`ëŠ” í•´ê²°í•˜ê¸° í˜ë“  ë¬¸ì œì´ë©°, ì´ê²Œ `Hooks`ì•ˆì— ë“¤ì–´ê°€ìˆë‹¤ë©´ í•´ê²°ì€ ë” í˜ë“¤ì–´ì§„ë‹¤.


ì´ë²ˆ ë¬¸ë‹¨ì—ì„œë„ ì˜ˆë¥¼ ë“¤ì–´ ì„¤ëª…í•˜ê² ë‹¤.

ë¨¼ì €, ë‹¤ìŒ í•¨ìˆ˜ `createIncrement`ëŠ” ê°’ì„ ì¦ê°€ì‹œí‚¤ëŠ” í•¨ìˆ˜ì™€, ê·¸ ê°’ì„ ë¡œê¹…í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë°°ì—´ë¡œ ë°˜í™˜í•œë‹¤. (ë§ì€ `Hooks`ê°€ í•´ë‹¹ í˜•íƒœë¥¼ ë„ê³ ìˆë‹¤)

```javascript
function createIncrement(incBy) {
  let value = 0;

  function increment() {
    value += incBy;
    console.log(value);
  }

  const message = `Current value is ${value}`;
  function log() {
    console.log(message);
  }
  
  return [increment, log];
}

const [increment, log] = createIncrement(1);
increment(); // 1
increment(); // 2
increment(); // 3
// ì—¬ê¸°ê¹Œì§„ ê´œì°®ì§€ë§Œ
log();       // "Current value is 0"
// ì˜ë„ëŠ” 3ì´ ë‚˜ì™€ì•¼í•œë‹¤.
```

ì™œ? ìš°ë¦¬ì˜ ì˜ë„ëŒ€ë¡œ "Current value is 3â€ì´ ë¡œê¹…ì´ ë˜ì§€ ì•Šê³ , "Current value is 0â€ì´ ëœê±¸ê¹Œ?  
í•´ë‹¹ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„  í•œ ì¤„ë§Œ ë°”ê¿”ì£¼ë©´ ëœë‹¤.

```javascript
function createIncrement(incBy) {
  let value = 0;

  function increment() {
    value += incBy;
    console.log(value);
  }

------
  const message = `Current value is ${value}`;
------
  function log() {
++++++
    const message = `Current value is ${value}`;
++++++
    console.log(message);
  }
  
  return [increment, log];
}

const [increment, log] = createIncrement(1);
increment(); // 1
increment(); // 2
increment(); // 3
log();       // "Current value is 3"
// ì˜ë„ëŒ€ë¡œ ì‘ë™í•œë‹¤
```

ìš°ë¦¬ëŠ” í´ë¡œì €ë¼ëŠ” ê°œë…ì„ í†µí•´, ê¸°ì¡´ ì½”ë“œ(ì˜ë„ëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•Šì€ ì½”ë“œ)ëŠ” `message `ë³€ìˆ˜ë¥¼ ìº¡ì³í•´ ê°€ì§€ê³  ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê³ ìˆë‹¤.  
ê·¸ë˜ì„œ `value`ê°€ ë³€í•˜ë”ë¼ë„ `message`ê°€ ì—…ë°ì´íŠ¸ ë˜ì§€ ì•Šì•˜ë˜ ê²ƒì´ë‹¤.

ìš°ë¦° ì´ëŸ° `log`ì™€ ê°™ì€ í•¨ìˆ˜ë¥¼ `ì˜¤ë˜ëœ í´ë¡œì €`ë¼ê³  ë¶€ë¥´ê¸°ë¡œ í–ˆë‹¤.

#### Hooksì—ì„œì˜ ì˜¤ë˜ëœ í´ë¡œì € ë¬¸ì œ

ë‹¤ìŒ ì»´í¬ë„ŒíŠ¸ëŠ”, 2ì´ˆë§ˆë‹¤ `count`ì˜ ê°’ì„ ë¡œê¹…í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë‹¤.  
`count`ì˜ ê°’ì€ ë²„íŠ¼ì„ í´ë¦­í•´ ì¦ê°€ì‹œí‚¬ ìˆ˜ ìˆë‹¤.

```javascript
function WatchCount() {
  const [count, setCount] = useState(0);

  useEffect(function() {
    setInterval(function log() {
      console.log(`Count is: ${count}`);
    }, 2000);
  }, []);

  return (
    <div>
      {count}
      <button onClick={() => setCount(count + 1) }>
        Increase
      </button>
    </div>
  );
}
```
[ë°ëª¨, ì˜¤ë˜ëœ í´ë¡œì € ë¬¸ì œ - CodeSandbox](https://codesandbox.io/s/oraedoen-keulrojeo-munje-gq6ny)

ëª‡ë²ˆì„ í´ë¦­í•´ë„ `count`ì˜ ê°’ì€ í•­ìƒ 0ì´ë‹¤.

![image](https://user-images.githubusercontent.com/42797995/103921431-da366500-5155-11eb-90e9-e5806fc0993a.png)

ë¬¸ì œì ì€ ëª¨ë‘ ì•Œë‹¤ì‹œí”¼, `useEffect`ì— ìˆëŠ” `log`ì— ìˆë‹¤. `log`ëŠ” ìƒì„±ë  ë•Œì˜ `count`ê°’, ì¦‰ 0ì„ **ìº¡ì²˜**í•´ ê°€ì§€ê³ ìˆë‹¤.  
ìš°ë¦¬ê°€ ì•„ë¬´ë¦¬ ë²„íŠ¼ì„ ëˆŒëŸ¬ë„ `log`í•¨ìˆ˜ëŠ” ìº¡ì²˜í•œ 0ë§Œ ê°€ì§€ê³  ìˆê³ , `count`ì˜ ê°’ì„ ì „í˜€ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.  

ì´ê²Œ **ì˜¤ë˜ëœ í´ë¡œì €**ì´ë‹¤.

ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ `useEffect`ì˜ ì¢…ì†ì„±ì— `count`ë¥¼ ì¶”ê°€í•˜ê³  ëª‡ê°€ì§€ ì‘ì—…ì„ ì¶”ê°€í–ˆë‹¤.

![image](https://user-images.githubusercontent.com/42797995/103921557-00f49b80-5156-11eb-973f-89ce7a07bac6.png)


```javascript
function WatchCount() {
  const [count, setCount] = useState(0);

  useEffect(
    function () {
-----
    setInterval(function log() {
      console.log(`Count is: ${count}`);
    }, 2000);
-----
+++++
      const id = setInterval(function log() {
        console.log(`Count is: ${count}`);
      }, 2000);
      return function () {
        clearInterval(id);
      };
+++++
    },
-----
    []
-----
+++++
    [count]
+++++
  );

  return (
    <div>
      {count}
      <button onClick={() => setCount(count + 1)}>Increase</button>
    </div>
  );
}
```
[ë°ëª¨, ì˜¤ë˜ëœ í´ë¡œì € ë¬¸ì œ í•´ê²° - CodeSandbox](https://codesandbox.io/s/oraedoen-keulrojeo-munje-haegyeol-8q006?file=/src/App.js)

í•´ê²°í–ˆëŠ”ë°ë„ **ë­”ê°€ ì˜ëª»ëœ ëŠë‚Œ**ì´ ë“ ë‹¤.

ì´ ë¬¸ì œëŠ” **ë¶ˆë³€ì„±**ê³¼ ì—°ê´€ë˜ê¸°ë„ í•˜ë‹¤. ì‹¤ì œë¡œ `React`ì˜ ë¶ˆë³€ì„± ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸°ìœ„í•œ ë§ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì´ publishë˜ì–´ìˆë‹¤.

- - - -

### 4. ì§„ì§œ ë„ˆë¬´ ë³µì¡í•œ íë¦„

ì´ëŸ° ì£¼ê´€ì ì¸ ì˜ê²¬ì€ ê¸°í”¼í•˜ì§€ë§Œ, ì •ë§ **ë„ˆë¬´ ë³µì¡í•˜ë‹¤.**  
ëª‡ê°œ ì •ë„ì˜ `useState`ê°€ ì“°ì´ëŠ” ì •ë„ëŠ” ë”°ë¼ê°ˆ ìˆ˜ ìˆì„ ì •ë„ì´ë‹¤. 

í•˜ì§€ë§Œ ìš°ë¦¬ê°€ ì‹¤ë¬´ì—ì„œ ì‘ì„±í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë“¤ì€ ê·¸ë ‡ì§€ ì•Šë‹¤.  
ëª‡ê°œì˜ ì»´í¬ë„ŒíŠ¸ê°€ ì¤‘ì²©ë˜ì–´ìˆê³ , ê°ì‹¸ì ¸ìˆëŠ” ì»´í¬ë„ŒíŠ¸ë“¤ë„ ëª‡ê°œì˜ `Hooks`ë¥¼ í˜¸ì¶œí•˜ê³ , ê·¸ `Hooks`ì—ì„œ ì¡°ì°¨ ë‹¤ë¥¸ `Hooks`(ê°€ì¥ ì§œì¦ë‚˜ëŠ” ê±´ useEffectë‹¤)ë¥¼ í˜¸ì¶œí•œë‹¤.

`Hooks hell`ì´ ë”°ë¡œì—†ë‹¤ ì •ë§. 

ì´ë¥¼ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•œ ì‹œí—˜ì´ ìˆë‹¤.
[React Hooks Quiz](https://docs.google.com/forms/d/e/1FAIpQLSdAG7QtzNT_-rl6j1bqJpJaq-5ZaLR_hnWUGvtVCR4vD5O_sA/viewform)

ìš°ë¦¬ëŠ” ê°œë°œì‹œê°„ì˜ 80%ëŠ” ì½”ë“œë¥¼ ì½ê¸°ìœ„í•´ íˆ¬ìí•œë‹¤. í•˜ì§€ë§Œ ì´ë ‡ê²Œ ë³µì¡í•œ íë¦„ì€ ì½”ë“œ ì½ê¸°ë¥¼ ì§œì¦ë‚˜ê²Œ ë§Œë“¤ë¿ë§Œ ì•„ë‹ˆë¼ `ì‚¬ì´ë“œ ì´í™íŠ¸`ë¥¼ ì°¾ê¸° í˜ë“¤ê³ , ë””ë²„ê¹…í•˜ê¸°ë„ í˜ë“¤ë‹¤.  

ì´ ë¬¸ì œì™€ ë‚´ê°€ ì„œìˆ í–ˆë˜ ë¬¸ì œë“¤ì´ ê²¹ì¹œë‹¤ë©´.. ìƒìƒí•˜ê¸°ë„ ì‹«ë‹¤.

- - - -

## ê²°ë¡ 
ë‚˜ëŠ” í¬ê²Œ ë„¤ê°€ì§€ ì´ìœ ë¥¼ ëŒ€ë©° `Hooks`ê°€ ì™œ ì‹¤íŒ¨í•œ ì„¤ê³„ì¸ì§€ ì„¤ëª…í–ˆë‹¤.  
ì´ ì„¸ê°€ì§€ ì´ìœ  ë§ê³ ë„ ë§ì€ ì´ìœ ê°€ ìˆê² ì§€ë§Œ, ê¸¸ì´ ê¸¸ì–´ì§ˆ ê²ƒ ê°™ì•„ ì´ë§Œ ì¤„ì´ë ¤í•œë‹¤.  

ë„¤ê°€ì§€ ì´ìœ ë¥¼ ìš”ì•½í•˜ìë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

- 1. `useEffect`ì˜ ì¢…ì†ì„± ë¹„êµ ë¬¸ì œ
	- ê°œë°œí•˜ë©° ê°™ì€ ë¬¸ì œê°€ ë°˜ë³µí•´ ë‚˜ì˜¨ë‹¤ëŠ” ê²ƒì€ ë‚´ê°€ ë©ì²­í•œ ê²Œ ì•„ë‹ˆë¼, ì„¤ê³„ê°€ ì˜ëª»ë˜ì–´ ìˆëŠ” ê±´ ì•„ë‹ê¹Œ?
- 2. `Hooks`ì˜ ê·œì¹™
	- `Hooks`ì˜ ê·œì¹™ì€ ê°œë°œ ë””ìì¸ íŒ¨í„´ì„ ê°•ì œí•œë‹¤, í•œê³„ë¥¼ ë§Œë“ ë‹¤.
	- ì´ëŸ° ë””ìì¸ íŒ¨í„´ ê°•ì œì™€ í•œê³„ê°€ **ë­”ê°€ ì˜ëª»ëœ ëŠë‚Œ**ì„ ì¤€ë‹¤.
- 3. `Hooks`ëŠ” í´ë¡œì €ì— ë„ˆë¬´ ì˜ì¡´í•œë‹¤.
	- `Hooks` ìì²´ê°€ í´ë¡œì €ì— ê¸°ë°˜í–ˆì§€ë§Œ, í´ë¡œì €ëŠ” ë„ˆë¬´ ì˜ˆìƒí•˜ê¸° í˜ë“¤ë‹¤.
- 4. ì§„ì§œ ë„ˆë¬´ ë³µì¡í•œ íë¦„
	- ì‚¬ì‹¤ ë‚´ê°€ ê°œë°œì„ ëª»í•´ì„œ ê·¸ëŸ°ê±°ë‹¤. ì£¼ê´€ì ì¸ ì£¼ì¥ì´ë‹¤.

ì´ ê¸€ì˜ ëª©ì ì€ â€œì§€ê¸ˆ ë‹¹ì¥ `Hooks`ì˜ ì‚¬ìš©ì„ ê·¸ë§Œë‘ê³ , `HOC`ë¡œ ëŒì•„ê°€ì„¸ìš”!â€œê°€ ì•„ë‹ˆë‹¤.  

ë‚´ê°€ ìƒê°í–ˆì„ ë•Œì—  `Hooks`ëŠ” ì´ëŸ° ë¬¸ì œì ì´ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ê·¸ë¦¬ê³  `Hooks`ë¥¼ ì‚¬ìš©í•˜ê¸° ì „, ì´ ê¸€ì„ ë³¸ë‹¤ë©´. ë³¸ê²©ì ìœ¼ë¡œ ê°œë°œí•  ë•Œ ì´ëŸ° ë‹¨ì ë“¤ì— ë¶„ëª… ê³µê°í•  ê²ƒì´ë‹¤.

- - - -

## ì‚¬ì¡±

ì‚¬ì‹¤ ë‚˜ëŠ” `Hooks`ê°€ ì™œ ì„±ê³µí•œ ì„¤ê³„ì¸ì§€ ë” ì˜ ì„œìˆ í•  ìˆ˜ ìˆë‹¤.  
ì•„ì§ê¹Œì§€ ë‚˜ëŠ” `Hooks`ì˜ íŒ¬ì´ê³  ì•„ì£¼ ì˜ ì‚¬ìš©í•˜ê³ ìˆë‹¤.

í¼ ë°œë¦¬ë°ì´ì…˜ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ `custom Hook`ì„ ë§Œë“œëŠ” ê³¼ì •ì—ì„œ `javascript`ì™€ `React` ê·¸ë¦¬ê³  `Hooks`ì— ëŒ€í•œ ë§ì€ íšŒì˜ê°ì´ ë“¤ì–´ ì´ ê²Œì‹œê¸€ì„ ì‘ì„±í•˜ë ¤ ìƒê°í–ˆë‹¤.

ëˆ„êµ°ê°€ì—ê²Œ ì´ ê¸€ì€ **ê·¸ì € ì§•ì§•ê¸€**ì´ë‹¤.  
ë‹¤ë¥¸ ëŒ€ì²´ì¬ëŠ” ì œì‹œí•˜ì§€ë„ ì•Šê³ , ì§€ê°€ ê°œë°œëª»í•´ì„œ ì´ëŸ° ë¶ˆë§Œì´ë‚˜ í•´ëŒ„ë‹¤ê³  ìƒê°í•  ìˆ˜ë„ ìˆë‹¤. 

ê·¸ë¦¬ê³  ì•ì—ì„œ jQueryì— ëŒ€í•´ ì„œìˆ í–ˆëŠ”ë°, ì´ ê²Œì‹œê¸€ì— ì„±ê²©ê³¼ ë§ì§€ ì•ŠëŠ” ê²ƒ ê°™ì•„ì„œ ë¹¼ë ¤ë‹¤ê°€.. ì–´ì°¨í”¼ í•˜ê³ ì‹¶ì€ ì–˜ê¸°ê¸°ë„ í•´ì„œ ê·¸ëƒ¥ í¬í•¨ì‹œì¼°ë‹¤.



## ì°¸ê³ ìë£Œ
[Frustrations with React Hooks - LogRocket Blog](https://blog.logrocket.com/frustrations-with-react-hooks/)
<https://github.com/slorber/react-async-hook>
[GitHub - alexreardon/use-memo-one: useMemo and useCallback but with a stable cache](https://github.com/alexreardon/use-memo-one)
[GitHub - slorber/react-async-hook: React hook to handle any async operation in React components, and prevent race conditions](https://github.com/slorber/react-async-hook)
<https://medium.com/swlh/the-ugly-side-of-hooks-584f0f8136b6>
<https://dmitripavlutin.com/react-hooks-stale-closures/>
[Why Do React Hooks Rely on Call Order? â€” Overreacted](https://overreacted.io/why-do-hooks-rely-on-call-order/)
<https://github.com/reactjs/rfcs/pull/68>
<https://dillonshook.com/a-critique-of-react-hooks/>